import{r,k as z,n as K,C as O,o as H,j as _,a as n,c as x,g as j}from"./app-e557c7c6.js";import{S as A,A as F}from"./AuthenticatedLayout-fe66bae3.js";import L from"./KomoditasSummaryTable-18340733.js";import $ from"./CardSkeleton-f5396957.js";import{I as M,S as P}from"./index-b4859f99.js";import{T as V}from"./Title-3632d3ff.js";import{m as B}from"./index-5adc1abf.js";import{S as D}from"./index-6bd818a5.js";import{a as U,B as X}from"./index-50b80eee.js";import{F as T,R as q,C as E}from"./index-e001bfba.js";import{S as G}from"./index-0194a331.js";import{D as J}from"./index-9fea25df.js";import{C as I}from"./index-d7752b6c.js";import{u as W}from"./useForceUpdate-46c57a70.js";import{S as Y}from"./Skeleton-d6fac526.js";import{A as Q,g as Z,m as ee}from"./AntdIcon-00a5507c.js";import{S as te}from"./SyncOutlined-e1439701.js";import"./Sider-e878b3e0.js";import"./LeftOutlined-26e8e4f2.js";import"./index-7ee738df.js";import"./responsiveObserver-f28a2943.js";import"./EllipsisOutlined-9956e50d.js";import"./Overflow-c337ad3f.js";import"./Keyframes-6852444d.js";import"./useFlexGapSupport-458b4d4a.js";import"./KeyCode-6413d982.js";import"./EditOutlined-6cc1ce15.js";import"./index-c55bd24a.js";import"./Table-b083898c.js";import"./styleChecker-390e3bce.js";import"./pickAttrs-f7d248bb.js";import"./addEventListener-4833daf9.js";import"./TextArea-b56a89be.js";import"./Dropdown-c371251e.js";import"./CheckOutlined-3f885691.js";import"./CloseOutlined-ee10c3cd.js";import"./EyeOutlined-52c12e5f.js";import"./ExclamationCircleFilled-78b22992.js";import"./InfoCircleFilled-0c5bce13.js";import"./index-8faaf65e.js";import"./PlusOutlined-9d2e728c.js";var ae={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M882 272.1V144c0-17.7-14.3-32-32-32H174c-17.7 0-32 14.3-32 32v128.1c-16.7 1-30 14.9-30 31.9v131.7a177 177 0 0014.4 70.4c4.3 10.2 9.6 19.8 15.6 28.9v345c0 17.6 14.3 32 32 32h676c17.7 0 32-14.3 32-32V535a175 175 0 0015.6-28.9c9.5-22.3 14.4-46 14.4-70.4V304c0-17-13.3-30.9-30-31.9zM214 184h596v88H214v-88zm362 656.1H448V736h128v104.1zm234 0H640V704c0-17.7-14.3-32-32-32H416c-17.7 0-32 14.3-32 32v136.1H214V597.9c2.9 1.4 5.9 2.8 9 4 22.3 9.4 46 14.1 70.4 14.1s48-4.7 70.4-14.1c13.8-5.8 26.8-13.2 38.7-22.1.2-.1.4-.1.6 0a180.4 180.4 0 0038.7 22.1c22.3 9.4 46 14.1 70.4 14.1 24.4 0 48-4.7 70.4-14.1 13.8-5.8 26.8-13.2 38.7-22.1.2-.1.4-.1.6 0a180.4 180.4 0 0038.7 22.1c22.3 9.4 46 14.1 70.4 14.1 24.4 0 48-4.7 70.4-14.1 3-1.3 6-2.6 9-4v242.2zm30-404.4c0 59.8-49 108.3-109.3 108.3-40.8 0-76.4-22.1-95.2-54.9-2.9-5-8.1-8.1-13.9-8.1h-.6c-5.7 0-11 3.1-13.9 8.1A109.24 109.24 0 01512 544c-40.7 0-76.2-22-95-54.7-3-5.1-8.4-8.3-14.3-8.3s-11.4 3.2-14.3 8.3a109.63 109.63 0 01-95.1 54.7C233 544 184 495.5 184 435.7v-91.2c0-.3.2-.5.5-.5h655c.3 0 .5.2.5.5v91.2z"}}]},name:"shop",theme:"outlined"};const oe=ae;var ne=function(t,e){return r.createElement(Q,z({},t,{ref:e,icon:oe}))};const re=r.forwardRef(ne),se=o=>{const{value:t,formatter:e,precision:i,decimalSeparator:u,groupSeparator:m="",prefixCls:s}=o;let d;if(typeof e=="function")d=e(t);else{const a=String(t),g=a.match(/^(-?)(\d*)(\.(\d+))?$/);if(!g||a==="-")d=a;else{const h=g[1];let c=g[2]||"0",k=g[4]||"";c=c.replace(/\B(?=(\d{3})+(?!\d))/g,m),typeof i=="number"&&(k=k.padEnd(i,"0").slice(0,i>0?i:0)),k&&(k=`${u}${k}`),d=[r.createElement("span",{key:"int",className:`${s}-content-value-int`},h,c),k&&r.createElement("span",{key:"decimal",className:`${s}-content-value-decimal`},k)]}}return r.createElement("span",{className:`${s}-content-value`},d)},ie=se,ce=o=>{const{componentCls:t,marginXXS:e,padding:i,colorTextDescription:u,titleFontSize:m,colorTextHeading:s,contentFontSize:d,fontFamily:a}=o;return{[`${t}`]:Object.assign(Object.assign({},K(o)),{[`${t}-title`]:{marginBottom:e,color:u,fontSize:m},[`${t}-skeleton`]:{paddingTop:i},[`${t}-content`]:{color:s,fontSize:d,fontFamily:a,[`${t}-content-value`]:{display:"inline-block",direction:"ltr"},[`${t}-content-prefix, ${t}-content-suffix`]:{display:"inline-block"},[`${t}-content-prefix`]:{marginInlineEnd:e},[`${t}-content-suffix`]:{marginInlineStart:e}}})}},le=Z("Statistic",o=>{const t=ee(o,{});return[ce(t)]},o=>{const{fontSizeHeading3:t,fontSize:e}=o;return{titleFontSize:e,contentFontSize:t}}),me=o=>{const{prefixCls:t,className:e,rootClassName:i,style:u,valueStyle:m,value:s=0,title:d,valueRender:a,prefix:g,suffix:h,loading:c=!1,onMouseEnter:k,onMouseLeave:S,decimalSeparator:v=".",groupSeparator:w=","}=o,{getPrefixCls:l,direction:f}=r.useContext(O),p=l("statistic",t),[y,C]=le(p),N=r.createElement(ie,Object.assign({decimalSeparator:v,groupSeparator:w,prefixCls:p},o,{value:s})),R=H(p,{[`${p}-rtl`]:f==="rtl"},e,i,C);return y(r.createElement("div",{className:R,style:u,onMouseEnter:k,onMouseLeave:S},d&&r.createElement("div",{className:`${p}-title`},d),r.createElement(Y,{paragraph:!1,loading:c,className:`${p}-skeleton`},r.createElement("div",{style:m,className:`${p}-content`},g&&r.createElement("span",{className:`${p}-content-prefix`},g),a?a(N):N,h&&r.createElement("span",{className:`${p}-content-suffix`},h)))))},b=me,de=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function pe(o,t){let e=o;const i=/\[[^\]]*]/g,u=(t.match(i)||[]).map(a=>a.slice(1,-1)),m=t.replace(i,"[]"),s=de.reduce((a,g)=>{let[h,c]=g;if(a.includes(h)){const k=Math.floor(e/c);return e-=k*c,a.replace(new RegExp(`${h}+`,"g"),S=>{const v=S.length;return k.toString().padStart(v,"0")})}return a},m);let d=0;return s.replace(i,()=>{const a=u[d];return d+=1,a})}function ue(o,t){const{format:e=""}=t,i=new Date(o).getTime(),u=Date.now(),m=Math.max(i-u,0);return pe(m,e)}const fe=1e3/30;function ke(o){return new Date(o).getTime()}const he=o=>{const{value:t,format:e="HH:mm:ss",onChange:i,onFinish:u}=o,m=W(),s=r.useRef(null),d=()=>{u==null||u(),s.current&&(clearInterval(s.current),s.current=null)},a=()=>{const c=ke(t);c>=Date.now()&&(s.current=setInterval(()=>{m(),i==null||i(c-Date.now()),c<Date.now()&&d()},fe))};r.useEffect(()=>(a(),()=>{s.current&&(clearInterval(s.current),s.current=null)}),[t]);const g=(c,k)=>ue(c,Object.assign(Object.assign({},k),{format:e})),h=c=>U(c,{title:void 0});return r.createElement(b,Object.assign({},o,{valueRender:h,formatter:g}))},ge=r.memo(he);b.Countdown=ge;const Se=o=>{const{placeholder:t="",value:e,prefixCls:i,disabled:u,onChange:m,handleClear:s}=o,d=r.useCallback(a=>{m==null||m(a),a.target.value===""&&(s==null||s())},[m]);return r.createElement(M,{placeholder:t,className:i,value:e,onChange:d,disabled:u,allowClear:!0,prefix:r.createElement(P,null)})},ve=Se,ye=()=>{const[o,t]=r.useState([]),[e,i]=r.useState(null),[u,m]=r.useState([]),[s,d]=r.useState(""),[a,g]=B.useMessage(),[h,c]=r.useState(!1);async function k(){try{const{data:l}=await x.get(route("api.wilayah.kabkot"));t(l.data.map(f=>({label:`[${f.kode_kabkot}] ${f.kabkot}`,value:f.kode_kabkot})))}catch(l){console.error("error fetch kabkot",l)}}async function S(l){try{c(!0),a.open({content:"memuat data...",type:"loading",key:"show-summary"});const f=await x.get(route("api.monitoring.rekap_kabkot",{kode_kabkot:l})),p=await x.get(route("api.monitoring.rekap_komoditas",{kode_kabkot:l})),y=f.data,C=p.data;i(y),m(C),a.open({content:"selesai memuat data.",type:"info",key:"show-summary"})}catch(f){a.open({content:"error memuat data.",type:"error",key:"show-summary"}),console.error("error fetch kabkot",f)}finally{c(!1)}}r.useEffect(()=>{k()},[]);function v(l){let f=setInterval(async()=>{try{const{data:p}=await x.get(route("api.dashboard.queue-status",{jobId:l}));p.status==="completed"&&(clearInterval(f),a.open({content:"sinkron data sudah selesai",type:"success",key:"sync"}))}catch(p){clearInterval(f),a.open({content:"error ketika cek status...",type:"error",key:"sync"}),console.log(p)}finally{j.get(route("dashboard"),{},{preserveScroll:!0,preserveState:!0})}},5e3)}async function w(){try{c(!0),a.open({content:"sedang sinkron data, anda bisa lanjut eksplorasi data",type:"loading",key:"sync",duration:0});const{data:l}=await x.get(route("dashboard.update"));l.job_id&&v(l.job_id),c(!1)}catch{a.open({content:"error ketika sinkron data...",type:"error",key:"sync"})}}return _("div",{children:[g,_(D,{direction:"horizontal",align:"center",style:{display:"flex",justifyContent:"space-between"},children:[n(V,{children:"Dashboard"}),n(X,{icon:n(te,{}),onClick:w,children:"Sync Data"})]}),n(T,{children:n(T.Item,{children:n(G,{options:[...o,{label:"[00] PROVINSI SULAWESI UTARA",value:"00"}],showSearch:!0,showArrow:!0,optionFilterProp:"label",placeholder:"Pilih Kabupaten/Kota",onChange:l=>S(l)})})}),n(J,{}),_(q,{gutter:16,children:[n(E,{span:8,children:n(I,{bordered:!1,children:h?n($,{}):n(b,{title:"Konsumsi Perkapita Perhari (Total)",value:e!=null&&e.konsumsi_perkapita_total?(e.konsumsi_perkapita_total/30).toLocaleString("id-ID"):"-",precision:3,valueStyle:{color:"#000"},prefix:n(A,{}),suffix:"kalori"})})}),n(E,{span:8,children:n(I,{bordered:!1,children:h?n($,{}):n(b,{title:"Konsumsi Perkapita Perhari (Basket Komoditas)",value:e!=null&&e.konsumsi_perkapita_basket_komoditas?(e.konsumsi_perkapita_basket_komoditas/30).toLocaleString("id-ID"):"-",precision:3,valueStyle:{color:"#3f8600"},prefix:n(re,{}),suffix:"kalori"})})}),n(E,{span:8,children:n(I,{bordered:!1,children:h?n($,{}):n(b,{title:"Garis Kemisikinan Sementara",value:e!=null&&e.garis_kemiskinan?e.garis_kemiskinan.toLocaleString("id-ID"):"-",precision:3,valueStyle:{color:"#3f8600"},prefix:"Rp ",suffix:""})})})]}),n(D,{direction:"vertical",style:{display:"block",marginTop:20},children:n(ve,{placeholder:"Cari berdasarkan nama atau kelompok komoditas",onChange:l=>{const f=l.target.value;d(f)}})}),n(L,{dataSource:u.filter(l=>{let f=l.nama_kelompok.toLowerCase(),p=l.nama_komoditas.toLowerCase();const y=`${f} ${p}`;return`${p} ${f}`.includes(s)||y.includes(s)}),loadingData:h})]})};ye.layout=o=>n(F,{user:o.props.auth.user,header:n("h2",{className:"",children:"index"}),selectedKey:"dashboard",children:o});export{ye as default};
