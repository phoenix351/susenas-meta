import{r as o,j as l,F as K,a as t,b as V,c as f,g as k}from"./app-e4c0373a.js";import{A as q}from"./AuthenticatedLayout-44da130b.js";import{U as G,C as Q,a as X,H as Y}from"./EditUserForm-e85ac078.js";import{l as Z}from"./lodash-8ec4aa93.js";import{M as w}from"./Modal-aeccb569.js";import{F as E}from"./index-48211e2c.js";import{m as ee}from"./index-8ef62069.js";import{S}from"./index-c5e6a5b8.js";import{B as n}from"./index-dfc0fd1d.js";import{T as te}from"./Table-d60d420f.js";import{T as ae}from"./index-db0a3f57.js";import{P as re}from"./index-ce431e94.js";import{I as oe,S as P}from"./index-5588b2d3.js";import{E as se,D as ne}from"./EditFilled-e1e54b1b.js";import"./Sider-dc1ae08f.js";import"./AntdIcon-afd26e9a.js";import"./LeftOutlined-afb6c5bd.js";import"./index-0939f339.js";import"./useForceUpdate-e1e6d3ff.js";import"./responsiveObserver-2bf891d6.js";import"./EllipsisOutlined-70edf86c.js";import"./Overflow-cda08727.js";import"./Keyframes-f3b01d4a.js";import"./useFlexGapSupport-95c54203.js";import"./KeyCode-6413d982.js";import"./EditOutlined-0f9afd6f.js";import"./index-c5cb5dc2.js";import"./index-ef5c41f7.js";import"./index-2d296126.js";import"./pickAttrs-afa7e219.js";import"./TextArea-3d18e405.js";import"./CheckOutlined-b439785a.js";import"./CloseOutlined-4c670781.js";import"./CONSTANT-6757a93f.js";import"./index-c327e034.js";import"./ExclamationCircleFilled-de59073a.js";import"./InfoCircleFilled-83407cbf.js";import"./ActionButton-e86323ad.js";import"./index-6d8133e3.js";import"./styleChecker-6f819655.js";import"./addEventListener-96c9f86c.js";import"./Dropdown-bc5e882c.js";import"./Title-8ddc04f3.js";import"./EyeOutlined-586f8865.js";const{Title:ie,Text:le}=ae,de=({users:d,kode_kabkot:x})=>{const[U,A]=o.useState([]),[L,c]=o.useState(!1),[M,m]=o.useState(!1),[B,u]=o.useState(!1),[I,C]=o.useState(!1),[j,h]=o.useState(""),[D,T]=o.useState(""),b=o.useRef(null),[g]=E.useForm(),[y]=E.useForm(),[s,_]=ee.useMessage();o.useEffect(()=>{A(d)},[d]);const F=(a,e,r)=>{e(),h(a[0]),T(r)},O=a=>{a(),h("")},$=a=>({filterDropdown:({setSelectedKeys:e,selectedKeys:r,confirm:i,clearFilters:v})=>l("div",{style:{padding:8},onKeyDown:p=>p.stopPropagation(),children:[t(oe,{ref:b,placeholder:`Search ${a}`,value:r[0],onChange:p=>e(p.target.value?[p.target.value]:[]),onPressEnter:()=>F(r,i,a),style:{marginBottom:8,display:"block"}}),l(S,{children:[t(n,{type:"primary",onClick:()=>F(r,i,a),icon:t(P,{}),size:"small",style:{width:90},children:"Search"}),t(n,{onClick:()=>v&&O(v),size:"small",style:{width:90},children:"Reset"}),t(n,{type:"link",size:"small",onClick:()=>{i(),h(r[0]),T(a)},children:"Filter"}),t(n,{type:"link",size:"small",onClick:()=>{close()},children:"close"})]})]}),filterIcon:e=>t(P,{style:{color:e?"#1677ff":void 0}}),onFilter:(e,r)=>r[a].toString().toLowerCase().includes(e.toLowerCase()),onFilterDropdownOpenChange:e=>{e&&setTimeout(()=>{var r;return(r=b.current)==null?void 0:r.select()},100)},render:e=>D===a?t(Y,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[j],autoEscape:!0,textToHighlight:e?e.toString():""}):t(le,{children:e})}),H=async a=>{try{m(!0);const{data:e}=await f.post(route("users.store"),a,{headers:{"Content-Type":"application/json"}});k.get(route("users.index"),{},{preserveScroll:!0,preserveState:!0}),e.status==="error"?s.open({content:e.message,type:"error",key:"add-user-dialog"}):s.open({content:e.message,type:"success",key:"add-user-dialog"}),m(!1),c(!1),g.resetFields()}catch(e){console.log({errror:e.response.data.message}),s.open({content:`Terjadi galat, ${e.response.data.message}`,type:"error",key:"add-user-dialog"}),m(!1)}},z=async a=>{try{C(!0);const{data:e}=await f.patch(route("users.update"),a,{headers:{"Content-Type":"application/json"}});e.status==="error"?s.open({content:e.message,type:"error",key:"add-user-dialog"}):(s.open({content:e.message,type:"success",key:"add-user-dialog"}),k.get(route("users.index"),{},{preserveScroll:!0,preserveState:!0})),u(!1)}catch(e){console.log({error:e}),s.open({content:`Terjadi galat, ${e.response.data.message}`,type:"error",key:"add-user-dialog"})}finally{C(!1)}},N=async a=>{try{const{data:e}=await f.delete(route("users.delete",{user:a}));s.open({content:"Berhasil menghapus 1 akun petugas",type:"success",key:"hapus-ruta"}),k.get(route("users.index"),{},{preserveScroll:!0,preserveState:!0})}catch(e){console.error("Error in add function:",e),s.open({content:"error",type:"error",key:"hapus-ruta",duration:3})}},R=(a,e)=>{y.setFieldsValue(e),u(!0)},W=Z.throttle(N,2e3),J=[{title:"Nama Petugas",dataIndex:"nama_lengkap",key:"nama_lengkap",sorter:(a,e)=>{const r=a.nama_lengkap.toLowerCase(),i=e.nama_lengkap.toLowerCase();return r<i?-1:r>i?1:0},...$("nama_lengkap")},{title:"Username",dataIndex:"username",key:"username"},{title:"Assignment",dataIndex:"kode_kabkot",key:"kode_kabkot",render:(a,e)=>`[71${e.kode_kabkot}] ${e.kabkot??"SULAWESI UTARA"}`},{title:"Peran",dataIndex:"role",key:"role"},{title:"Jabatan",dataIndex:"jabatan",key:"jabatan"},{title:"Kode Identitas (NIP/NIK)",dataIndex:"nip",key:"nip"},{title:"Edit",dataIndex:"ubah",key:"ubah",render:(a,e)=>l(n,{type:"default",onClick:()=>R(a,e),children:[t(se,{})," ubah"]})},{title:"Delete",dataIndex:"entri",key:"entri",render:(a,e)=>t(re,{placement:"topLeft",title:"apakah anda yakin akan menghapus ruta ini?",description:"hapus anggota rumah tangga",okText:"yakin dong",cancelText:"nyanda",onConfirm:()=>W(e.id),children:l(n,{type:"default",style:{color:"red"},children:[t(ne,{})," hapus"]})})}];return l(K,{children:[t(V,{title:"Users"}),t(ie,{level:2,children:"Pengelolaan Petugas"}),_,t(S,{style:{marginBottom:"10px",marginTop:"10px",width:"100%",justifyContent:"end"},children:l(n,{type:"primary",onClick:()=>c(!0),children:[t(G,{}),"Tambah Petugas"]})}),t(S,{style:{backgroundColor:"#fff",width:"100%",minHeight:"300px",padding:"10px 15px"},direction:"vertical",children:t(te,{columns:J,dataSource:U,scroll:{x:"100%"}})}),t(w,{handleOk:()=>{g.submit()},okText:"Buat",confirmLoadingModal:M,handleCancel:()=>c(!1),openModal:L,title:"Tambah Petugas Baru",cancelText:"Batalkan",children:t(Q,{kode_kabkot:x,form:g,onFinish:H})},"add-modal"),t(w,{handleOk:()=>y.submit(),okText:"Buat",confirmLoadingModal:I,handleCancel:()=>u(!1),openModal:B,title:"Ubah Akun Petugas",cancelText:"Batalkan",children:t(X,{kode_kabkot:x,form:y,onFinish:z})},"add-modal")]})};de.layout=d=>t(q,{user:d.props.auth.user,header:t("h2",{className:"",children:"Users"}),selectedKey:"users",children:d});export{de as default};
