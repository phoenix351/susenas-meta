import{r as o,_ as I,a as t,F as D,j as c,c as b,b as E,g as C}from"./app-5d0b70f5.js";import{A as V}from"./AuthenticatedLayout-f75216ef.js";import{m as K}from"./index-78ba8854.js";import{F as k}from"./index-3ba58409.js";import{S as g}from"./index-c0f70985.js";import{B as h}from"./index-65c35e7d.js";import{R as $,P as A}from"./ReloadOutlined-f4d732a1.js";import{l as H}from"./lodash-46a9d5dc.js";import{S as w}from"./index-8ca95db8.js";import{A as P}from"./AntdIcon-fa0127d1.js";import{T as N}from"./Table-ccdbe276.js";import{E as R}from"./EditFilled-114ea433.js";import"./Sider-6188eb25.js";import"./index-8056d16e.js";import"./KeyCode-dbe0232e.js";import"./index-a9241260.js";import"./addEventListener-ce52f1f6.js";var T={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 256H736v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zm-200 0H360v-72h304v72z"}}]},name:"delete",theme:"filled"};const j=T;var B=function(l,s){return o.createElement(P,I({},l,{ref:s,icon:j}))};const M=o.forwardRef(B);var O={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M696 480H544V328c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v152H328c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h152v152c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V544h152c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"plus-circle",theme:"outlined"};const z=O;var L=function(l,s){return o.createElement(P,I({},l,{ref:s,icon:z}))};const U=o.forwardRef(L),W=({form:a,onFinish:l,setDataSource:s})=>{const[i,f]=K.useMessage(),m=[{label:"[71] SULAWESI UTARA",value:"71"}],[d,y]=o.useState([]);o.useState([]);const[F,v]=o.useState(!0),[x,p]=o.useState([]),S=async()=>{const e=route("api.entri.kabkot"),{data:n}=await b.get(e),_=n.data.map(u=>({label:`[${u.kode_kabkot}] ${u.kabkot}`,value:u.kode_kabkot}));n.kode_kabkot==="00"?v(!1):a.setFieldValue("kode_kabkot",n.kode_kabkot),y(_)},r=async()=>{const e=route("api.entri.nks",{kodeKabkot:a.getFieldValue("kode_kabkot"),semester:a.getFieldValue("semester")}),{data:n}=await b.get(e),_=n.map(u=>({label:u,value:u}));p(_)};return o.useEffect(()=>{try{S(),a.setFieldValue("kode_prov","71")}catch{}},[]),t(D,{children:c(k,{form:a,name:"EntriIntiForm",onFinish:l,autoComplete:"off",style:{width:"300px"},children:[f,t(k.Item,{name:"kode_prov",label:"Provinsi",children:t(g,{allowClear:!0,showSearch:!0,disabled:!0,optionFilterProp:"label",options:m,onClear:()=>{},onChange:()=>{a.setFieldsValue({kode_kabkot:"",semester:"",nks:""}),s([]),p([])}})}),t(k.Item,{name:"kode_kabkot",label:"Kab/Kota",children:t(g,{allowClear:!0,showSearch:!0,disabled:F,optionFilterProp:"label",options:d,onChange:()=>{a.setFieldsValue({semester:"",nks:""}),s([]),p([])}})}),t(k.Item,{name:"semester",label:"semester",children:t(g,{allowClear:!0,showSearch:!0,optionFilterProp:"label",options:[{label:"Semester I",value:"1",selected:!0}],onChange:()=>{r()}})}),t(k.Item,{name:"nks",label:"NKS",children:t(g,{allowClear:!0,showSearch:!0,optionFilterProp:"label",options:x,onChange:()=>{r(),a.submit()}})}),c(h,{type:"primary",onClick:()=>a.submit(),children:[t($,{})," Refresh"]})]})})},q=({data_susenas:a,nks:l,kode_kabkot:s})=>{o.useEffect(()=>{a.length>0&&(i.setFieldsValue({nks:l,kode_kabkot:s,semester:"1"}),m(a))},[]);const[i]=k.useForm(),[f,m]=o.useState([]),[d,y]=K.useMessage(),F=async r=>{console.log({values:r}),d.open({type:"loading",key:"cari",content:"Memuat Data"});try{const e=route("api.entri.mak",r),{data:n}=await b.get(e);m(n.data),d.open({type:"success",key:"cari",content:"Berhasil mengambil data"})}catch{d.open({type:"error",key:"cari",content:"Oops terjadi kesalahan, silahkan hubungi admin"})}},v=async r=>{try{const{data:e}=await b.delete(route("entri.mak.delete",{id_ruta:r}));d.open({content:"Berhasil menghapus 1 anggota rumah tangga",type:"success",key:"hapus-ruta"}),C.get(route("entri",{kode_kabkot:i.getFieldValue("kode_kabkot"),nks:i.getFieldValue("nks")}))}catch(e){d.open({content:`Terjadi galat ketika menghapus data, tunjukan code ini pada Developer (${e})`,type:"error",key:"hapus-ruta",duration:3})}},x=H.throttle(v,2e3),p={clean:"green",error:"red",warning:"yellow",entri:"#fff"},S=[{title:"No",dataIndex:"id",key:"id",render:(r,e,n)=>n+1},{title:"Kecamatan",dataIndex:"kec",key:"kec",render:(r,e)=>`[${e.kode_kec}] ${e.kec}`},{title:"Desa",dataIndex:"desa",key:"desa",render:(r,e)=>`[${e.kode_desa}] ${e.desa}`},{title:"Blok Sensus",dataIndex:"kode_bs4",key:"kode_bs4"},{title:"No Urut Sampel",dataIndex:"r109",key:"r109"},{title:"Nama KRT",dataIndex:"r110",key:"r110"},{title:"Alamat",dataIndex:"r111",key:"r111"},{title:"Nama PML",dataIndex:"nama_lengkap",key:"nama_lengkap"},{title:"Status",dataIndex:"status_dok",key:"status_dok",render:r=>t(h,{style:{backgroundColor:p[r],fontWeight:600},type:"primary",children:r})},{title:"Entri",dataIndex:"entri",key:"entri",render:(r,e)=>c(h,{type:"primary",onClick:()=>C.get(`${route("entri.mak.edit",{id:e.id})}`),children:[t(R,{})," entri"]})},{title:"Delete",dataIndex:"entri",key:"entri",render:(r,e)=>t(A,{placement:"topLeft",title:"apakah anda yakin akan menghapus ruta ini?",description:"hapus anggota rumah tangga",okText:"yakin dong",cancelText:"nyanda",onConfirm:()=>x(e.id),children:c(h,{type:"default",children:[t(M,{})," hapus"]})})}];return c(D,{children:[y,t(E,{title:"Entri Kuesioner Inti"}),c(w,{style:{backgroundColor:"#fff",width:"100%",minHeight:"300px",padding:"10px 15px"},direction:"vertical",children:[t(W,{setDataSource:m,form:i,onFinish:F}),t(w,{style:{width:"100%",justifyContent:"end"},children:c(h,{type:"primary",disabled:!i.getFieldValue("nks"),onClick:()=>C.visit(route("entri.mak.create",i.getFieldsValue())),children:[t(U,{})," Tambah Ruta"]})}),t(N,{dataSource:f,columns:S}),";"]})]})};q.layout=a=>t(V,{user:a.props.auth.user,header:t("h2",{className:"",children:"Dashboard"}),selectedKey:"entri",children:a});export{q as default};
