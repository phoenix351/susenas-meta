import{r,j as f,F as w,a as t,c as m}from"./app-e557c7c6.js";import{M as g}from"./Modal-4c078e0c.js";import{A as B}from"./AuthenticatedLayout-fe66bae3.js";import h from"./KomoditasForm-7f4ea4c8.js";import{m as N}from"./index-5adc1abf.js";import{F as A}from"./index-e001bfba.js";import{P as _}from"./index-ad9ef77b.js";import{B as p}from"./index-50b80eee.js";import{P as D}from"./PlusOutlined-9d2e728c.js";import{T as L}from"./Table-b083898c.js";import{R as U}from"./ReloadOutlined-d1e954a8.js";import{E as R}from"./EditOutlined-6cc1ce15.js";import{D as j}from"./DeleteOutlined-679bbd02.js";import"./index-78fa511a.js";import"./ExclamationCircleFilled-78b22992.js";import"./AntdIcon-00a5507c.js";import"./InfoCircleFilled-0c5bce13.js";import"./ActionButton-16f2b61f.js";import"./useFlexGapSupport-458b4d4a.js";import"./index-30528bf8.js";import"./KeyCode-6413d982.js";import"./pickAttrs-f7d248bb.js";import"./Keyframes-6852444d.js";import"./CloseOutlined-ee10c3cd.js";import"./index-9fea25df.js";import"./Sider-e878b3e0.js";import"./LeftOutlined-26e8e4f2.js";import"./index-6bd818a5.js";import"./index-7ee738df.js";import"./useForceUpdate-46c57a70.js";import"./responsiveObserver-f28a2943.js";import"./EllipsisOutlined-9956e50d.js";import"./Overflow-c337ad3f.js";import"./index-c55bd24a.js";import"./index-b4859f99.js";import"./TextArea-b56a89be.js";import"./EyeOutlined-52c12e5f.js";import"./index-0194a331.js";import"./CheckOutlined-3f885691.js";import"./styleChecker-390e3bce.js";import"./addEventListener-4833daf9.js";import"./Dropdown-c371251e.js";const P=()=>{const[s,b]=r.useState([]),[x,l]=r.useState(!1),[F,k]=r.useState(!1),[u,T]=r.useState(!1),[c,i]=r.useState(!1),[a,M]=N.useMessage(),[n]=A.useForm();async function d(){try{a.open({type:"loading",content:"mengambil data dari server",key:"get-data"});const{data:e}=await m.get(route("api.mak.komoditas.list"));b(e),a.destroy("get-data")}catch{a.open({type:"error",content:"error ketika mengambil data",key:"get-data"})}}async function I(e){try{a.open({content:"menyimpan data",type:"loading",key:"save"}),e.flag_basket=Number(e.flag_basket);const o=await m.put(route("komoditas.update"),e);d(),a.open({content:"data berhasil disimpan",type:"success",key:"save"})}catch{a.open({content:"data gagal disimpan, hubungi admin untuk diperiksa",type:"error",key:"save"})}finally{l(!1)}}async function K(e){try{a.open({content:"menambahkan komoditas",type:"loading",key:"store"}),e.flag_basket=Number(e.flag_basket);const o=await m.post(route("komoditas.store"),e);d(),a.open({content:"data berhasil disimpan",type:"success",key:"store"})}catch{a.open({content:"data gagal disimpan, hubungi admin untuk diperiksa",type:"error",key:"store"})}}async function S(e){try{a.open({content:"menghapus komoditas",type:"loading",key:"destroy"});const o=await m.delete(route("komoditas.destroy",{id:e}));d(),a.open({content:"data berhasil dihapus",type:"warning",key:"destroy"})}catch(o){console.log(o),a.open({content:"data gagal dihapus, hubungi admin untuk diperiksa",type:"error",key:"destroy"})}}r.useEffect(()=>{d()},[]);function C(e,o){const O=!!o.flag_basket;i(O),e.setFieldsValue(o),l(!0)}const E=[{title:"nomor_urut",dataIndex:"nomor_urut",key:"nomor_urut"},{title:"nama_komoditas",dataIndex:"nama_komoditas",key:"nama_komoditas"},{title:"id_kelompok",dataIndex:"id_kelompok",key:"id_kelompok"},{title:"nama_kelompok",dataIndex:"nama_kelompok",key:"nama_kelompok"},{title:"satuan",dataIndex:"satuan",key:"satuan"},{title:"kalori",dataIndex:"kalori",key:"kalori"},{title:"flag_basket",dataIndex:"flag_basket",key:"flag_basket"},{title:"type",dataIndex:"type",key:"type"},{title:"Actions",key:"actions",children:[{title:"Edit",dataIndex:"edit",key:"edit",render:(e,o)=>f(p,{onClick:()=>C(n,o),children:[t(R,{})," "]}),onHeaderCell:()=>({colSpan:0})},{title:"Delete",dataIndex:"delete",key:"delete",render:(e,o)=>t(_,{title:`Apakah anda yakin akan menghapus komoditas ${o.nama_komoditas} ?`,onConfirm:()=>{S(o.id)},children:t(p,{children:t(j,{})})}),onHeaderCell:()=>({colSpan:0})}]}];function y(){i(!c)}return f(w,{children:[M,t("div",{children:"Komoditas"}),t(_,{title:"Nomor Urut akan direset sesuai urutan yang sekarang dari 1 sampai n",onConfirm:async()=>{try{a.open({type:"loading",content:"Sedang Mengurutkan kembali Komoditas",key:"urut"});const e=await m.get(route("komoditas.sort"));a.open({type:"success",content:"Selesai mengurutkan Komoditas",key:"urut"}),d()}catch{a.open({type:"error",content:"Terjadi kesalahan, silahkan hubungi pengembang.",key:"urut"})}},children:t(p,{icon:t(U,{}),children:"Reset Nomor Urut"})}),t(p,{icon:t(D,{}),onClick:()=>{n.setFieldsValue({nama_komoditas:"New Item",id_kelompok:1,nama_kelompok:"B. UMBI-UMBIAN [R.9 s.d. R.15]",satuan:"Kg",kode_coicop:"NULL",kalori:1135,flag_basket:0,type:"standar"}),k(!0)},children:"Komoditas"}),t(L,{dataSource:s,columns:E}),t(g,{title:"Edit Komoditas",openModal:x,handleCancel:()=>{n.resetFields(),l(!1),i(!1)},handleOk:()=>{n.submit(),l(!1),i(!1)},confirmLoadingModal:u,children:t(h,{form:n,onFinish:I,flag:c,SwitchFlag:y})}),t(g,{title:"Tambah Komoditas",openModal:F,handleCancel:()=>{n.resetFields(),k(!1),i(!1)},handleOk:()=>{n.submit(),k(!1),i(!1)},confirmLoadingModal:u,children:t(h,{form:n,daftarKomoditas:s,onFinish:K,flag:c,SwitchFlag:y})})]})};P.layout=s=>t(B,{user:s.props.auth.user,header:t("h2",{className:"",children:"Kelola Komoditas"}),selectedKey:"komoditas",children:s});export{P as default};
