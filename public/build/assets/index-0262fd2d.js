import{r as n,i as T,n as R,C as K,o as j,j as $,a as r,c as x,g as A}from"./app-594863b6.js";import{A as F}from"./AuthenticatedLayout-231fcac0.js";import L from"./KomoditasSummaryTable-7d6e7d25.js";import _ from"./CardSkeleton-355e3e12.js";import{I as M,S as V}from"./index-d3be9ffc.js";import{T as P}from"./Title-c3ea1799.js";import{m as B}from"./index-1014857c.js";import{S as D}from"./index-a6fc668a.js";import{a as U,B as X}from"./index-04d30823.js";import{F as O,R as q,C as E}from"./index-6ed6d14d.js";import{S as G}from"./index-bd19dd3e.js";import{D as J}from"./index-695b4647.js";import{C as I}from"./index-42bfbca1.js";import{u as W}from"./useForceUpdate-6e0d1c94.js";import{S as Y}from"./Skeleton-5b8e9056.js";import{A as z,g as Q,m as Z}from"./AntdIcon-175e4fcc.js";import{S as ee}from"./SyncOutlined-6b3baa28.js";import"./Sider-dec78fca.js";import"./LeftOutlined-64be42a7.js";import"./index-9f703954.js";import"./responsiveObserver-358d8654.js";import"./EllipsisOutlined-be96201e.js";import"./Overflow-9030fe5e.js";import"./Keyframes-65d81fe9.js";import"./useFlexGapSupport-d518330e.js";import"./KeyCode-6413d982.js";import"./EditOutlined-07cea508.js";import"./index-7ac5cd43.js";import"./Table-b6992ce4.js";import"./styleChecker-3b719b20.js";import"./pickAttrs-acf9f8e7.js";import"./addEventListener-bf1b69dc.js";import"./TextArea-77b1be0c.js";import"./Dropdown-aef8ec3e.js";import"./CheckOutlined-eae11d92.js";import"./CloseOutlined-4e52efbe.js";import"./EyeOutlined-236aefdd.js";import"./ExclamationCircleFilled-6172b0ab.js";import"./InfoCircleFilled-9dafb05f.js";import"./index-f346a5cf.js";import"./PlusOutlined-5aa03c3a.js";var te={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M882 272.1V144c0-17.7-14.3-32-32-32H174c-17.7 0-32 14.3-32 32v128.1c-16.7 1-30 14.9-30 31.9v131.7a177 177 0 0014.4 70.4c4.3 10.2 9.6 19.8 15.6 28.9v345c0 17.6 14.3 32 32 32h676c17.7 0 32-14.3 32-32V535a175 175 0 0015.6-28.9c9.5-22.3 14.4-46 14.4-70.4V304c0-17-13.3-30.9-30-31.9zM214 184h596v88H214v-88zm362 656.1H448V736h128v104.1zm234 0H640V704c0-17.7-14.3-32-32-32H416c-17.7 0-32 14.3-32 32v136.1H214V597.9c2.9 1.4 5.9 2.8 9 4 22.3 9.4 46 14.1 70.4 14.1s48-4.7 70.4-14.1c13.8-5.8 26.8-13.2 38.7-22.1.2-.1.4-.1.6 0a180.4 180.4 0 0038.7 22.1c22.3 9.4 46 14.1 70.4 14.1 24.4 0 48-4.7 70.4-14.1 13.8-5.8 26.8-13.2 38.7-22.1.2-.1.4-.1.6 0a180.4 180.4 0 0038.7 22.1c22.3 9.4 46 14.1 70.4 14.1 24.4 0 48-4.7 70.4-14.1 3-1.3 6-2.6 9-4v242.2zm30-404.4c0 59.8-49 108.3-109.3 108.3-40.8 0-76.4-22.1-95.2-54.9-2.9-5-8.1-8.1-13.9-8.1h-.6c-5.7 0-11 3.1-13.9 8.1A109.24 109.24 0 01512 544c-40.7 0-76.2-22-95-54.7-3-5.1-8.4-8.3-14.3-8.3s-11.4 3.2-14.3 8.3a109.63 109.63 0 01-95.1 54.7C233 544 184 495.5 184 435.7v-91.2c0-.3.2-.5.5-.5h655c.3 0 .5.2.5.5v91.2z"}}]},name:"shop",theme:"outlined"};const ae=te;var oe=function(t,e){return n.createElement(z,T({},t,{ref:e,icon:ae}))};const ne=n.forwardRef(oe);var re={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 312H696v-16c0-101.6-82.4-184-184-184s-184 82.4-184 184v16H192c-17.7 0-32 14.3-32 32v536c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V344c0-17.7-14.3-32-32-32zm-432-16c0-61.9 50.1-112 112-112s112 50.1 112 112v16H400v-16zm392 544H232V384h96v88c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-88h224v88c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-88h96v456z"}}]},name:"shopping",theme:"outlined"};const se=re;var ie=function(t,e){return n.createElement(z,T({},t,{ref:e,icon:se}))};const ce=n.forwardRef(ie),le=a=>{const{value:t,formatter:e,precision:i,decimalSeparator:u,groupSeparator:m="",prefixCls:s}=a;let p;if(typeof e=="function")p=e(t);else{const o=String(t),k=o.match(/^(-?)(\d*)(\.(\d+))?$/);if(!k||o==="-")p=o;else{const g=k[1];let c=k[2]||"0",h=k[4]||"";c=c.replace(/\B(?=(\d{3})+(?!\d))/g,m),typeof i=="number"&&(h=h.padEnd(i,"0").slice(0,i>0?i:0)),h&&(h=`${u}${h}`),p=[n.createElement("span",{key:"int",className:`${s}-content-value-int`},g,c),h&&n.createElement("span",{key:"decimal",className:`${s}-content-value-decimal`},h)]}}return n.createElement("span",{className:`${s}-content-value`},p)},me=le,pe=a=>{const{componentCls:t,marginXXS:e,padding:i,colorTextDescription:u,titleFontSize:m,colorTextHeading:s,contentFontSize:p,fontFamily:o}=a;return{[`${t}`]:Object.assign(Object.assign({},R(a)),{[`${t}-title`]:{marginBottom:e,color:u,fontSize:m},[`${t}-skeleton`]:{paddingTop:i},[`${t}-content`]:{color:s,fontSize:p,fontFamily:o,[`${t}-content-value`]:{display:"inline-block",direction:"ltr"},[`${t}-content-prefix, ${t}-content-suffix`]:{display:"inline-block"},[`${t}-content-prefix`]:{marginInlineEnd:e},[`${t}-content-suffix`]:{marginInlineStart:e}}})}},de=Q("Statistic",a=>{const t=Z(a,{});return[pe(t)]},a=>{const{fontSizeHeading3:t,fontSize:e}=a;return{titleFontSize:e,contentFontSize:t}}),ue=a=>{const{prefixCls:t,className:e,rootClassName:i,style:u,valueStyle:m,value:s=0,title:p,valueRender:o,prefix:k,suffix:g,loading:c=!1,onMouseEnter:h,onMouseLeave:v,decimalSeparator:S=".",groupSeparator:C=","}=a,{getPrefixCls:l,direction:f}=n.useContext(K),d=l("statistic",t),[y,w]=de(d),N=n.createElement(me,Object.assign({decimalSeparator:S,groupSeparator:C,prefixCls:d},a,{value:s})),H=j(d,{[`${d}-rtl`]:f==="rtl"},e,i,w);return y(n.createElement("div",{className:H,style:u,onMouseEnter:h,onMouseLeave:v},p&&n.createElement("div",{className:`${d}-title`},p),n.createElement(Y,{paragraph:!1,loading:c,className:`${d}-skeleton`},n.createElement("div",{style:m,className:`${d}-content`},k&&n.createElement("span",{className:`${d}-content-prefix`},k),o?o(N):N,g&&n.createElement("span",{className:`${d}-content-suffix`},g)))))},b=ue,fe=[["Y",1e3*60*60*24*365],["M",1e3*60*60*24*30],["D",1e3*60*60*24],["H",1e3*60*60],["m",1e3*60],["s",1e3],["S",1]];function he(a,t){let e=a;const i=/\[[^\]]*]/g,u=(t.match(i)||[]).map(o=>o.slice(1,-1)),m=t.replace(i,"[]"),s=fe.reduce((o,k)=>{let[g,c]=k;if(o.includes(g)){const h=Math.floor(e/c);return e-=h*c,o.replace(new RegExp(`${g}+`,"g"),v=>{const S=v.length;return h.toString().padStart(S,"0")})}return o},m);let p=0;return s.replace(i,()=>{const o=u[p];return p+=1,o})}function ge(a,t){const{format:e=""}=t,i=new Date(a).getTime(),u=Date.now(),m=Math.max(i-u,0);return he(m,e)}const ke=1e3/30;function ve(a){return new Date(a).getTime()}const Se=a=>{const{value:t,format:e="HH:mm:ss",onChange:i,onFinish:u}=a,m=W(),s=n.useRef(null),p=()=>{u==null||u(),s.current&&(clearInterval(s.current),s.current=null)},o=()=>{const c=ve(t);c>=Date.now()&&(s.current=setInterval(()=>{m(),i==null||i(c-Date.now()),c<Date.now()&&p()},ke))};n.useEffect(()=>(o(),()=>{s.current&&(clearInterval(s.current),s.current=null)}),[t]);const k=(c,h)=>ge(c,Object.assign(Object.assign({},h),{format:e})),g=c=>U(c,{title:void 0});return n.createElement(b,Object.assign({},a,{valueRender:g,formatter:k}))},ye=n.memo(Se);b.Countdown=ye;const xe=a=>{const{placeholder:t="",value:e,prefixCls:i,disabled:u,onChange:m,handleClear:s}=a,p=n.useCallback(o=>{m==null||m(o),o.target.value===""&&(s==null||s())},[m]);return n.createElement(M,{placeholder:t,className:i,value:e,onChange:p,disabled:u,allowClear:!0,prefix:n.createElement(V,null)})},be=xe,we=()=>{const[a,t]=n.useState([]),[e,i]=n.useState(null),[u,m]=n.useState([]),[s,p]=n.useState(""),[o,k]=B.useMessage(),[g,c]=n.useState(!1);async function h(){try{const{data:l}=await x.get(route("api.wilayah.kabkot"));t(l.data.map(f=>({label:`[${f.kode_kabkot}] ${f.kabkot}`,value:f.kode_kabkot})))}catch(l){console.error("error fetch kabkot",l)}}async function v(l){try{c(!0),o.open({content:"memuat data...",type:"loading",key:"show-summary"});const f=await x.get(route("api.monitoring.rekap_kabkot",{kode_kabkot:l})),d=await x.get(route("api.monitoring.rekap_komoditas",{kode_kabkot:l})),y=f.data,w=d.data;i(y),m(w),o.open({content:"selesai memuat data.",type:"info",key:"show-summary"})}catch(f){o.open({content:"error memuat data.",type:"error",key:"show-summary"}),console.error("error fetch kabkot",f)}finally{c(!1)}}n.useEffect(()=>{h()},[]);function S(l){let f=setInterval(async()=>{try{const{data:d}=await x.get(route("api.dashboard.queue-status",{jobId:l}));d.status==="completed"&&(clearInterval(f),o.open({content:"sinkron data sudah selesai",type:"success",key:"sync"}))}catch(d){clearInterval(f),o.open({content:"error ketika cek status...",type:"error",key:"sync"}),console.log(d)}finally{A.get(route("dashboard"),{},{preserveScroll:!0,preserveState:!0})}},5e3)}async function C(){try{c(!0),o.open({content:"sedang sinkron data, anda bisa lanjut eksplorasi data",type:"loading",key:"sync",duration:0});const{data:l}=await x.get(route("dashboard.update"));l.job_id&&S(l.job_id),c(!1)}catch{o.open({content:"error ketika sinkron data...",type:"error",key:"sync"})}}return $("div",{children:[k,$(D,{direction:"horizontal",align:"center",style:{display:"flex",justifyContent:"space-between"},children:[r(P,{children:"Dashboard"}),r(X,{icon:r(ee,{}),onClick:C,children:"Sync Data"})]}),r(O,{children:r(O.Item,{children:r(G,{options:[...a,{label:"[00] PROVINSI SULAWESI UTARA",value:"00"}],showSearch:!0,showArrow:!0,optionFilterProp:"label",placeholder:"Pilih Kabupaten/Kota",onChange:l=>v(l)})})}),r(J,{}),$(q,{gutter:16,children:[r(E,{span:8,children:r(I,{bordered:!1,children:g?r(_,{}):r(b,{title:"Konsumsi Perkapita Perhari (Total)",value:e!=null&&e.konsumsi_perkapita_total?(e.konsumsi_perkapita_total/30).toLocaleString("id-ID"):"-",precision:3,valueStyle:{color:"#000"},prefix:r(ce,{}),suffix:"kalori"})})}),r(E,{span:8,children:r(I,{bordered:!1,children:g?r(_,{}):r(b,{title:"Konsumsi Perkapita Perhari (Basket Komoditas)",value:e!=null&&e.konsumsi_perkapita_basket_komoditas?(e.konsumsi_perkapita_basket_komoditas/30).toLocaleString("id-ID"):"-",precision:3,valueStyle:{color:"#3f8600"},prefix:r(ne,{}),suffix:"kalori"})})}),r(E,{span:8,children:r(I,{bordered:!1,children:g?r(_,{}):r(b,{title:"Garis Kemisikinan Sementara",value:e!=null&&e.garis_kemiskinan?e.garis_kemiskinan.toLocaleString("id-ID"):"-",precision:3,valueStyle:{color:"#3f8600"},prefix:"Rp ",suffix:""})})})]}),r(D,{direction:"vertical",style:{display:"block",marginTop:20},children:r(be,{placeholder:"Cari berdasarkan nama atau kelompok komoditas",onChange:l=>{const f=l.target.value;p(f)}})}),r(L,{dataSource:u.filter(l=>{let f=l.nama_kelompok.toLowerCase(),d=l.nama_komoditas.toLowerCase();const y=`${f} ${d}`;return`${d} ${f}`.includes(s)||y.includes(s)}),loadingData:g})]})};we.layout=a=>r(F,{user:a.props.auth.user,header:r("h2",{className:"",children:"index"}),selectedKey:"dashboard",children:a});export{we as default};
