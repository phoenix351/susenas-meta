import{r as o,j as l,F as K,a as t,b as V,c as f,g as k}from"./app-cade510b.js";import{A as q}from"./AuthenticatedLayout-2e91c2e1.js";import{U as G,C as Q,a as X,H as Y}from"./EditUserForm-8f759d7d.js";import{l as Z}from"./lodash-a1f3770e.js";import{M as w}from"./Modal-283bab31.js";import{F as E}from"./index-5ce765d1.js";import{m as ee}from"./index-b93aae69.js";import{S}from"./index-efbdf8f9.js";import{B as n}from"./index-beeaf8d9.js";import{T as te}from"./Table-675fb605.js";import{T as ae}from"./index-821a731c.js";import{P as re}from"./index-7d10e982.js";import{I as oe,S as P}from"./index-b9cc14aa.js";import{E as se,D as ne}from"./EditFilled-70275b9f.js";import"./Sider-26ba9cdb.js";import"./AntdIcon-da8305e3.js";import"./LeftOutlined-a53789c4.js";import"./index-c911b603.js";import"./useForceUpdate-a75d9b98.js";import"./responsiveObserver-bed5db2e.js";import"./EllipsisOutlined-7069c36e.js";import"./Overflow-133b988e.js";import"./Keyframes-24838d9a.js";import"./useFlexGapSupport-8646280d.js";import"./KeyCode-6413d982.js";import"./EditOutlined-229e823d.js";import"./index-e3d5dafc.js";import"./index-af8f5ca6.js";import"./index-f9258c5c.js";import"./pickAttrs-01b563d9.js";import"./TextArea-9a7525ca.js";import"./CloseCircleFilled-a13e8288.js";import"./CheckOutlined-c54abbe5.js";import"./CloseOutlined-0d8c520e.js";import"./CONSTANT-6757a93f.js";import"./index-c24da6a1.js";import"./ExclamationCircleFilled-1864351a.js";import"./InfoCircleFilled-7f3ebebf.js";import"./ActionButton-0f136a84.js";import"./index-54100e18.js";import"./styleChecker-9cc21804.js";import"./addEventListener-61db0605.js";import"./Dropdown-531b1aaa.js";import"./Title-821d3901.js";import"./EyeOutlined-a718312b.js";const{Title:ie,Text:le}=ae,de=({users:d,kode_kabkot:x})=>{const[U,A]=o.useState([]),[L,c]=o.useState(!1),[M,m]=o.useState(!1),[B,u]=o.useState(!1),[I,C]=o.useState(!1),[j,h]=o.useState(""),[D,T]=o.useState(""),b=o.useRef(null),[g]=E.useForm(),[y]=E.useForm(),[s,_]=ee.useMessage();o.useEffect(()=>{A(d)},[d]);const F=(a,e,r)=>{e(),h(a[0]),T(r)},O=a=>{a(),h("")},$=a=>({filterDropdown:({setSelectedKeys:e,selectedKeys:r,confirm:i,clearFilters:v})=>l("div",{style:{padding:8},onKeyDown:p=>p.stopPropagation(),children:[t(oe,{ref:b,placeholder:`Search ${a}`,value:r[0],onChange:p=>e(p.target.value?[p.target.value]:[]),onPressEnter:()=>F(r,i,a),style:{marginBottom:8,display:"block"}}),l(S,{children:[t(n,{type:"primary",onClick:()=>F(r,i,a),icon:t(P,{}),size:"small",style:{width:90},children:"Search"}),t(n,{onClick:()=>v&&O(v),size:"small",style:{width:90},children:"Reset"}),t(n,{type:"link",size:"small",onClick:()=>{i(),h(r[0]),T(a)},children:"Filter"}),t(n,{type:"link",size:"small",onClick:()=>{close()},children:"close"})]})]}),filterIcon:e=>t(P,{style:{color:e?"#1677ff":void 0}}),onFilter:(e,r)=>r[a].toString().toLowerCase().includes(e.toLowerCase()),onFilterDropdownOpenChange:e=>{e&&setTimeout(()=>{var r;return(r=b.current)==null?void 0:r.select()},100)},render:e=>D===a?t(Y,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[j],autoEscape:!0,textToHighlight:e?e.toString():""}):t(le,{children:e})}),H=async a=>{try{m(!0);const{data:e}=await f.post(route("users.store"),a,{headers:{"Content-Type":"application/json"}});k.get(route("users.index"),{},{preserveScroll:!0,preserveState:!0}),e.status==="error"?s.open({content:e.message,type:"error",key:"add-user-dialog"}):s.open({content:e.message,type:"success",key:"add-user-dialog"}),m(!1),c(!1),g.resetFields()}catch(e){console.log({errror:e.response.data.message}),s.open({content:`Terjadi galat, ${e.response.data.message}`,type:"error",key:"add-user-dialog"}),m(!1)}},z=async a=>{try{C(!0);const{data:e}=await f.patch(route("users.update"),a,{headers:{"Content-Type":"application/json"}});e.status==="error"?s.open({content:e.message,type:"error",key:"add-user-dialog"}):(s.open({content:e.message,type:"success",key:"add-user-dialog"}),k.get(route("users.index"),{},{preserveScroll:!0,preserveState:!0})),u(!1)}catch(e){console.log({error:e}),s.open({content:`Terjadi galat, ${e.response.data.message}`,type:"error",key:"add-user-dialog"})}finally{C(!1)}},N=async a=>{try{const{data:e}=await f.delete(route("users.delete",{user:a}));s.open({content:"Berhasil menghapus 1 akun petugas",type:"success",key:"hapus-ruta"}),k.get(route("users.index"),{},{preserveScroll:!0,preserveState:!0})}catch(e){console.error("Error in add function:",e),s.open({content:"error",type:"error",key:"hapus-ruta",duration:3})}},R=(a,e)=>{y.setFieldsValue(e),u(!0)},W=Z.throttle(N,2e3),J=[{title:"Nama Petugas",dataIndex:"nama_lengkap",key:"nama_lengkap",sorter:(a,e)=>{const r=a.nama_lengkap.toLowerCase(),i=e.nama_lengkap.toLowerCase();return r<i?-1:r>i?1:0},...$("nama_lengkap")},{title:"Username",dataIndex:"username",key:"username"},{title:"Assignment",dataIndex:"kode_kabkot",key:"kode_kabkot",render:(a,e)=>`[71${e.kode_kabkot}] ${e.kabkot??"SULAWESI UTARA"}`},{title:"Peran",dataIndex:"role",key:"role"},{title:"Jabatan",dataIndex:"jabatan",key:"jabatan"},{title:"Kode Identitas (NIP/NIK)",dataIndex:"nip",key:"nip"},{title:"Edit",dataIndex:"ubah",key:"ubah",render:(a,e)=>l(n,{type:"default",onClick:()=>R(a,e),children:[t(se,{})," ubah"]})},{title:"Delete",dataIndex:"entri",key:"entri",render:(a,e)=>t(re,{placement:"topLeft",title:"apakah anda yakin akan menghapus ruta ini?",description:"hapus anggota rumah tangga",okText:"yakin dong",cancelText:"nyanda",onConfirm:()=>W(e.id),children:l(n,{type:"default",style:{color:"red"},children:[t(ne,{})," hapus"]})})}];return l(K,{children:[t(V,{title:"Users"}),t(ie,{level:2,children:"Pengelolaan Petugas"}),_,t(S,{style:{marginBottom:"10px",marginTop:"10px",width:"100%",justifyContent:"end"},children:l(n,{type:"primary",onClick:()=>c(!0),children:[t(G,{}),"Tambah Petugas"]})}),t(S,{style:{backgroundColor:"#fff",width:"100%",minHeight:"300px",padding:"10px 15px"},direction:"vertical",children:t(te,{columns:J,dataSource:U,scroll:{x:"100%"}})}),t(w,{handleOk:()=>{g.submit()},okText:"Buat",confirmLoadingModal:M,handleCancel:()=>c(!1),openModal:L,title:"Tambah Petugas Baru",cancelText:"Batalkan",children:t(Q,{kode_kabkot:x,form:g,onFinish:H})},"add-modal"),t(w,{handleOk:()=>y.submit(),okText:"Buat",confirmLoadingModal:I,handleCancel:()=>u(!1),openModal:B,title:"Ubah Akun Petugas",cancelText:"Batalkan",children:t(X,{kode_kabkot:x,form:y,onFinish:z})},"add-modal")]})};de.layout=d=>t(q,{user:d.props.auth.user,header:t("h2",{className:"",children:"Users"}),selectedKey:"users",children:d});export{de as default};
