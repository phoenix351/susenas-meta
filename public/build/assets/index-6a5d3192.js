import{r as o,j as l,F as K,a as t,b as V,c as f,g as k}from"./app-594863b6.js";import{A as q}from"./AuthenticatedLayout-231fcac0.js";import{U as G,C as Q,a as X,H as Y}from"./EditUserForm-43023e52.js";import{l as Z}from"./lodash-e70d9550.js";import{M as w}from"./Modal-bf79f3e0.js";import{F as E}from"./index-6ed6d14d.js";import{m as ee}from"./index-1014857c.js";import{S}from"./index-a6fc668a.js";import{B as n}from"./index-04d30823.js";import{T as te}from"./Table-b6992ce4.js";import{T as ae}from"./index-c4629e43.js";import{P as re}from"./index-fa5a21dc.js";import{I as oe,S as P}from"./index-d3be9ffc.js";import{E as se,D as ne}from"./EditFilled-d2d74527.js";import"./Sider-dec78fca.js";import"./AntdIcon-175e4fcc.js";import"./LeftOutlined-64be42a7.js";import"./index-9f703954.js";import"./useForceUpdate-6e0d1c94.js";import"./responsiveObserver-358d8654.js";import"./EllipsisOutlined-be96201e.js";import"./Overflow-9030fe5e.js";import"./Keyframes-65d81fe9.js";import"./useFlexGapSupport-d518330e.js";import"./KeyCode-6413d982.js";import"./EditOutlined-07cea508.js";import"./index-695b4647.js";import"./index-7ac5cd43.js";import"./index-bd19dd3e.js";import"./pickAttrs-acf9f8e7.js";import"./TextArea-77b1be0c.js";import"./CheckOutlined-eae11d92.js";import"./CloseOutlined-4e52efbe.js";import"./CONSTANT-6757a93f.js";import"./index-79e201cd.js";import"./ExclamationCircleFilled-6172b0ab.js";import"./InfoCircleFilled-9dafb05f.js";import"./ActionButton-1e6dc3ca.js";import"./index-f50bfcb7.js";import"./styleChecker-3b719b20.js";import"./addEventListener-bf1b69dc.js";import"./Dropdown-aef8ec3e.js";import"./Title-c3ea1799.js";import"./EyeOutlined-236aefdd.js";const{Title:ie,Text:le}=ae,de=({users:d,kode_kabkot:x})=>{const[U,A]=o.useState([]),[L,c]=o.useState(!1),[M,m]=o.useState(!1),[B,u]=o.useState(!1),[I,C]=o.useState(!1),[j,h]=o.useState(""),[D,T]=o.useState(""),b=o.useRef(null),[g]=E.useForm(),[y]=E.useForm(),[s,_]=ee.useMessage();o.useEffect(()=>{A(d)},[d]);const F=(a,e,r)=>{e(),h(a[0]),T(r)},O=a=>{a(),h("")},$=a=>({filterDropdown:({setSelectedKeys:e,selectedKeys:r,confirm:i,clearFilters:v})=>l("div",{style:{padding:8},onKeyDown:p=>p.stopPropagation(),children:[t(oe,{ref:b,placeholder:`Search ${a}`,value:r[0],onChange:p=>e(p.target.value?[p.target.value]:[]),onPressEnter:()=>F(r,i,a),style:{marginBottom:8,display:"block"}}),l(S,{children:[t(n,{type:"primary",onClick:()=>F(r,i,a),icon:t(P,{}),size:"small",style:{width:90},children:"Search"}),t(n,{onClick:()=>v&&O(v),size:"small",style:{width:90},children:"Reset"}),t(n,{type:"link",size:"small",onClick:()=>{i(),h(r[0]),T(a)},children:"Filter"}),t(n,{type:"link",size:"small",onClick:()=>{close()},children:"close"})]})]}),filterIcon:e=>t(P,{style:{color:e?"#1677ff":void 0}}),onFilter:(e,r)=>r[a].toString().toLowerCase().includes(e.toLowerCase()),onFilterDropdownOpenChange:e=>{e&&setTimeout(()=>{var r;return(r=b.current)==null?void 0:r.select()},100)},render:e=>D===a?t(Y,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[j],autoEscape:!0,textToHighlight:e?e.toString():""}):t(le,{children:e})}),H=async a=>{try{m(!0);const{data:e}=await f.post(route("users.store"),a,{headers:{"Content-Type":"application/json"}});k.get(route("users.index"),{},{preserveScroll:!0,preserveState:!0}),e.status==="error"?s.open({content:e.message,type:"error",key:"add-user-dialog"}):s.open({content:e.message,type:"success",key:"add-user-dialog"}),m(!1),c(!1),g.resetFields()}catch(e){console.log({errror:e.response.data.message}),s.open({content:`Terjadi galat, ${e.response.data.message}`,type:"error",key:"add-user-dialog"}),m(!1)}},z=async a=>{try{C(!0);const{data:e}=await f.patch(route("users.update"),a,{headers:{"Content-Type":"application/json"}});e.status==="error"?s.open({content:e.message,type:"error",key:"add-user-dialog"}):(s.open({content:e.message,type:"success",key:"add-user-dialog"}),k.get(route("users.index"),{},{preserveScroll:!0,preserveState:!0})),u(!1)}catch(e){console.log({error:e}),s.open({content:`Terjadi galat, ${e.response.data.message}`,type:"error",key:"add-user-dialog"})}finally{C(!1)}},N=async a=>{try{const{data:e}=await f.delete(route("users.delete",{user:a}));s.open({content:"Berhasil menghapus 1 akun petugas",type:"success",key:"hapus-ruta"}),k.get(route("users.index"),{},{preserveScroll:!0,preserveState:!0})}catch(e){console.error("Error in add function:",e),s.open({content:"error",type:"error",key:"hapus-ruta",duration:3})}},R=(a,e)=>{y.setFieldsValue(e),u(!0)},W=Z.throttle(N,2e3),J=[{title:"Nama Petugas",dataIndex:"nama_lengkap",key:"nama_lengkap",sorter:(a,e)=>{const r=a.nama_lengkap.toLowerCase(),i=e.nama_lengkap.toLowerCase();return r<i?-1:r>i?1:0},...$("nama_lengkap")},{title:"Username",dataIndex:"username",key:"username"},{title:"Assignment",dataIndex:"kode_kabkot",key:"kode_kabkot",render:(a,e)=>`[71${e.kode_kabkot}] ${e.kabkot??"SULAWESI UTARA"}`},{title:"Peran",dataIndex:"role",key:"role"},{title:"Jabatan",dataIndex:"jabatan",key:"jabatan"},{title:"Kode Identitas (NIP/NIK)",dataIndex:"nip",key:"nip"},{title:"Edit",dataIndex:"ubah",key:"ubah",render:(a,e)=>l(n,{type:"default",onClick:()=>R(a,e),children:[t(se,{})," ubah"]})},{title:"Delete",dataIndex:"entri",key:"entri",render:(a,e)=>t(re,{placement:"topLeft",title:"apakah anda yakin akan menghapus ruta ini?",description:"hapus anggota rumah tangga",okText:"yakin dong",cancelText:"nyanda",onConfirm:()=>W(e.id),children:l(n,{type:"default",style:{color:"red"},children:[t(ne,{})," hapus"]})})}];return l(K,{children:[t(V,{title:"Users"}),t(ie,{level:2,children:"Pengelolaan Petugas"}),_,t(S,{style:{marginBottom:"10px",marginTop:"10px",width:"100%",justifyContent:"end"},children:l(n,{type:"primary",onClick:()=>c(!0),children:[t(G,{}),"Tambah Petugas"]})}),t(S,{style:{backgroundColor:"#fff",width:"100%",minHeight:"300px",padding:"10px 15px"},direction:"vertical",children:t(te,{columns:J,dataSource:U,scroll:{x:"100%"}})}),t(w,{handleOk:()=>{g.submit()},okText:"Buat",confirmLoadingModal:M,handleCancel:()=>c(!1),openModal:L,title:"Tambah Petugas Baru",cancelText:"Batalkan",children:t(Q,{kode_kabkot:x,form:g,onFinish:H})},"add-modal"),t(w,{handleOk:()=>y.submit(),okText:"Buat",confirmLoadingModal:I,handleCancel:()=>u(!1),openModal:B,title:"Ubah Akun Petugas",cancelText:"Batalkan",children:t(X,{kode_kabkot:x,form:y,onFinish:z})},"add-modal")]})};de.layout=d=>t(q,{user:d.props.auth.user,header:t("h2",{className:"",children:"Users"}),selectedKey:"users",children:d});export{de as default};
